&lt;p class=&quot;text&quot; style=&quot;word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px; width: 1020px; font-weight: bold; color: rgb(0, 0, 0); font-size: 24px; line-height: 36px;&quot;&gt;&lt;br/&gt;&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51);&quot;&gt;&lt;strong style=&quot;word-wrap: break-word; font-size: 1em;&quot;&gt;摘要：&lt;/strong&gt;先说环境： Ubuntu 14.04.4 LTS (GNU/Linux 3.13.0-52-generic x86_64) PHP 5.5.9-1ubuntu4.19 (cli)实战过程手头上有一个加密过的项目和一个php扩展的动态连接库(jinhou.so)。PHP代码类似如下的样子：?php /* xxxx ...&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 0px; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;先说环境：&lt;/p&gt;&lt;pre class=&quot;hljs nginx&quot; style=&quot;word-wrap: break-word; padding: 1em; margin-top: 0px; margin-bottom: 1.5em; font-size: 0.93em; box-sizing: border-box; overflow: auto; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 1.3; word-break: break-all; color: rgb(101, 123, 131); border: none; border-radius: 3px; max-height: 35em; position: relative;&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Ubuntu&amp;nbsp;14.04.4&amp;nbsp;LTS&amp;nbsp;(GNU/Linux&amp;nbsp;3.13.0-52-generic&amp;nbsp;x86_64)
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;PHP&amp;nbsp;5.5.9-1ubuntu4.19&amp;nbsp;(cli)&lt;/pre&gt;&lt;h2 style=&quot;word-wrap: break-word; margin: 1.5em 0px 0px; padding: 0px 0px 10px; font-size: 1.75em; font-weight: 500; box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 1.2; color: rgb(51, 51, 51); border-bottom: 1px solid rgb(238, 238, 238);&quot;&gt;实战过程&lt;/h2&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;手头上有一个加密过的项目和一个php扩展的动态连接库(jinhou.so)。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;PHP代码类似如下的样子：&lt;/p&gt;&lt;pre style=&quot;word-wrap: break-word; padding: 1em; margin-top: 1.5em; margin-bottom: 1.5em; font-size: 0.93em; box-sizing: border-box; overflow: auto; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 1.3; word-break: break-all; color: rgb(51, 51, 51); border: none; border-radius: 3px; max-height: 35em; position: relative;&quot;&gt;&amp;lt;?php/*&amp;nbsp;xxxx技术有限公司版权所有:&amp;nbsp;2016-09-08&amp;nbsp;08:18:00&amp;nbsp;*/jhgo(&amp;#39;uGpqefbDEBkqp4preQ2UaAp3RAUeJAZ5s4aERAQMkxbJTgEovHnQw6WxsA99sAhSacJCLGxZL4Q4u6zFyGveuDUoemktHGkMaB5D&amp;#39;);?&amp;gt;&lt;/pre&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;根据上面分析到的已知条件有：&lt;/p&gt;&lt;ol style=&quot;list-style-type: none;&quot; class=&quot; list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px; box-sizing: border-box;&quot;&gt;加密方式类似 eval 的加密方式。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px; box-sizing: border-box;&quot;&gt;jhgo 包含执行代码跟解密代码。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px; box-sizing: border-box;&quot;&gt;jinhou.so 里面包含 jhgo 函数。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;首先非常粗暴的用 VIM 打开 jinhou.so 看看有没有什么关键的信息。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;&lt;img src=&quot;https://segmentfault.com/img/bVDAwo?w=996&amp;h=86&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;很不幸，明文写着解决方案的出处。&lt;a href=&quot;https://github.com/eixom/zoeeyguard&quot; target=&quot;_blank&quot; style=&quot;word-wrap: break-word; color: rgb(0, 154, 97); text-decoration: none; outline: 0px; transition-property: color; transition-duration: 0.3s; transition-timing-function: ease; box-sizing: border-box; background: transparent;&quot;&gt;https://github.com/eixom/zoee...&lt;/a&gt;&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;看了代码理论上这个扩展暴露出来有两个方法，一个执行加密文件的方法和一个解密文件的方法。但实际上只有一个方法暴露出来，那么还有一个被狡猾的提供者删除了。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;当然源码我们都有了也就不计较那么多了。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;试着用官方源码编译下然后decode一下发现还是不行。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;再仔细研究了一下，发现&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;&lt;img src=&quot;https://segmentfault.com/img/bVDAwo?w=996&amp;h=86&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;里面有一串很神奇的字符串:&amp;nbsp;&lt;code style=&quot;word-wrap: break-word; font-size: 0.93em; box-sizing: border-box; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; background-color: rgb(249, 242, 244);&quot;&gt;82dsa7dsas32112389uy7aydh8h2h2i412&lt;/code&gt;&amp;nbsp;心想是不是他的加密Key。再翻代码果真是。在&lt;code style=&quot;word-wrap: break-word; font-size: 0.93em; box-sizing: border-box; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; background-color: rgb(249, 242, 244);&quot;&gt;https://github.com/eixom/zoeeyguard/blob/master/src/guard.h&lt;/code&gt;&amp;nbsp;文件里面。&lt;br/&gt;原来的是&amp;nbsp;&lt;code style=&quot;word-wrap: break-word; font-size: 0.93em; box-sizing: border-box; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; color: rgb(199, 37, 78); padding: 2px 4px; border-radius: 3px; background-color: rgb(249, 242, 244);&quot;&gt;28dsa7dsas12312389uy7aydh8h1h2i312&lt;/code&gt;。改完之后发现还是不行。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;果真我还是Too Young Too Simple啊。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;&lt;span style=&quot;word-wrap: break-word; box-sizing: border-box; font-weight: 700;&quot;&gt;程序员心理角度分析下：一般没人会去改代码，基本上都是动动参数而已。&lt;/span&gt;是不是还有其他参数改动了？可是其他参数都是数组格式的这可头疼了。&lt;/p&gt;&lt;pre class=&quot;hljs cpp&quot; style=&quot;word-wrap: break-word; padding: 1em; margin-top: 0px; margin-bottom: 1.5em; font-size: 0.93em; box-sizing: border-box; overflow: auto; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 1.3; word-break: break-all; color: rgb(101, 123, 131); border: none; border-radius: 3px; max-height: 35em; position: relative;&quot;&gt;/*&amp;nbsp;&amp;nbsp;private&amp;nbsp;key&amp;nbsp;*/#define&amp;nbsp;PRIVATE_KEY&amp;nbsp;&amp;quot;28dsa7dsas12312389uy7aydh8h1h2i312&amp;quot;#define&amp;nbsp;PRIVATE_KEY_LEN&amp;nbsp;sizeof(PRIVATE_KEY)/*&amp;nbsp;order&amp;nbsp;*/static&amp;nbsp;const&amp;nbsp;unsigned&amp;nbsp;char&amp;nbsp;OBFUSCATED_ORDER[]&amp;nbsp;=&amp;nbsp;{&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;13,&amp;nbsp;&amp;nbsp;6,&amp;nbsp;&amp;nbsp;5,&amp;nbsp;&amp;nbsp;7,&amp;nbsp;&amp;nbsp;1,&amp;nbsp;15,&amp;nbsp;14,&amp;nbsp;20
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;nbsp;9,&amp;nbsp;16,&amp;nbsp;19,&amp;nbsp;&amp;nbsp;4,&amp;nbsp;18,&amp;nbsp;10,&amp;nbsp;&amp;nbsp;2,&amp;nbsp;&amp;nbsp;8
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;12,&amp;nbsp;&amp;nbsp;3,&amp;nbsp;11,&amp;nbsp;&amp;nbsp;0,&amp;nbsp;17};#define&amp;nbsp;ORDER_SIZE&amp;nbsp;sizeof(OBFUSCATED_ORDER)&amp;nbsp;/&amp;nbsp;sizeof(*&amp;nbsp;OBFUSCATED_ORDER)/*&amp;nbsp;alphabet&amp;nbsp;for&amp;nbsp;base64&amp;nbsp;*/static&amp;nbsp;const&amp;nbsp;unsigned&amp;nbsp;char&amp;nbsp;OBFUSCATED_ALPHABET[]&amp;nbsp;=&amp;nbsp;{&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#39;s&amp;#39;,&amp;nbsp;&amp;#39;4&amp;#39;,&amp;nbsp;&amp;#39;N&amp;#39;,&amp;nbsp;&amp;#39;E&amp;#39;,&amp;nbsp;&amp;#39;k&amp;#39;,&amp;nbsp;&amp;#39;X&amp;#39;,&amp;nbsp;&amp;#39;c&amp;#39;,&amp;nbsp;&amp;#39;u&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;J&amp;#39;,&amp;nbsp;&amp;#39;2&amp;#39;,&amp;nbsp;&amp;#39;U&amp;#39;,&amp;nbsp;&amp;#39;o&amp;#39;,&amp;nbsp;&amp;#39;O&amp;#39;,&amp;nbsp;&amp;#39;w&amp;#39;,&amp;nbsp;&amp;#39;K&amp;#39;,&amp;nbsp;&amp;#39;v&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;h&amp;#39;,&amp;nbsp;&amp;#39;H&amp;#39;,&amp;nbsp;&amp;#39;C&amp;#39;,&amp;nbsp;&amp;#39;/&amp;#39;,&amp;nbsp;&amp;#39;D&amp;#39;,&amp;nbsp;&amp;#39;q&amp;#39;,&amp;nbsp;&amp;#39;l&amp;#39;,&amp;nbsp;&amp;#39;R&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;B&amp;#39;,&amp;nbsp;&amp;#39;r&amp;#39;,&amp;nbsp;&amp;#39;5&amp;#39;,&amp;nbsp;&amp;#39;Z&amp;#39;,&amp;nbsp;&amp;#39;S&amp;#39;,&amp;nbsp;&amp;#39;Q&amp;#39;,&amp;nbsp;&amp;#39;6&amp;#39;,&amp;nbsp;&amp;#39;W&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;3&amp;#39;,&amp;nbsp;&amp;#39;L&amp;#39;,&amp;nbsp;&amp;#39;j&amp;#39;,&amp;nbsp;&amp;#39;8&amp;#39;,&amp;nbsp;&amp;#39;1&amp;#39;,&amp;nbsp;&amp;#39;z&amp;#39;,&amp;nbsp;&amp;#39;0&amp;#39;,&amp;nbsp;&amp;#39;G&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;n&amp;#39;,&amp;nbsp;&amp;#39;e&amp;#39;,&amp;nbsp;&amp;#39;y&amp;#39;,&amp;nbsp;&amp;#39;b&amp;#39;,&amp;nbsp;&amp;#39;I&amp;#39;,&amp;nbsp;&amp;#39;d&amp;#39;,&amp;nbsp;&amp;#39;i&amp;#39;,&amp;nbsp;&amp;#39;P&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;A&amp;#39;,&amp;nbsp;&amp;#39;9&amp;#39;,&amp;nbsp;&amp;#39;7&amp;#39;,&amp;nbsp;&amp;#39;+&amp;#39;,&amp;nbsp;&amp;#39;m&amp;#39;,&amp;nbsp;&amp;#39;V&amp;#39;,&amp;nbsp;&amp;#39;M&amp;#39;,&amp;nbsp;&amp;#39;Y&amp;#39;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;,&amp;nbsp;&amp;#39;F&amp;#39;,&amp;nbsp;&amp;#39;g&amp;#39;,&amp;nbsp;&amp;#39;f&amp;#39;,&amp;nbsp;&amp;#39;p&amp;#39;,&amp;nbsp;&amp;#39;a&amp;#39;,&amp;nbsp;&amp;#39;T&amp;#39;,&amp;nbsp;&amp;#39;t&amp;#39;,&amp;nbsp;&amp;#39;x&amp;#39;};#define&amp;nbsp;ALPHABET_SIZE&amp;nbsp;64&lt;/pre&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;这个时候得请出大杀器了：IDA Pro v6.8，反编译神器。左边是正常版本，右边是jinhou.so。&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;&lt;img src=&quot;https://segmentfault.com/img/bVDAyW?w=1524&amp;h=356&quot;/&gt;&lt;/p&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 1.5em; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;根据数据更改guard.h里面的文件。重新编译下，果真成功解密出来了。&lt;/p&gt;&lt;pre class=&quot;hljs xml&quot; style=&quot;word-wrap: break-word; padding: 1em; margin-top: 0px; margin-bottom: 1.5em; font-size: 0.93em; box-sizing: border-box; overflow: auto; font-family: &amp;quot;Source Code Pro&amp;quot;, Consolas, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; line-height: 1.3; word-break: break-all; color: rgb(101, 123, 131); border: none; border-radius: 3px; max-height: 35em; position: relative;&quot;&gt;&amp;lt;?phprequire_cache(APP_PATH.&amp;#39;/Lib/Action/User/AddonAction.class.php&amp;#39;);?&amp;gt;&lt;/pre&gt;&lt;h2 style=&quot;word-wrap: break-word; margin: 1.5em 0px 0px; padding: 0px 0px 10px; font-size: 1.75em; font-weight: 500; box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 1.2; color: rgb(51, 51, 51); border-bottom: 1px solid rgb(238, 238, 238);&quot;&gt;事后总结&lt;/h2&gt;&lt;p style=&quot;word-wrap: break-word; margin-top: 1.5em; margin-bottom: 0px; padding: 0px; color: rgb(51, 51, 51); box-sizing: border-box; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;WenQuanYi Micro Hei&amp;quot;, &amp;quot;Microsoft Yahei&amp;quot;, sans-serif; line-height: 22.4px;&quot;&gt;1、 这次破解没花费多少时间，主要感谢加密方案跟加密代码已经明文告诉我们。&lt;br/&gt;2、 主要的时间是在试探加密参数上，很幸运的是.so文件也没有加壳。&lt;br/&gt;3、 在破解的过程中也了解了PHP加密的缺陷性，所以才有了下一篇文章：通用PHP加密文件还原方法。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;